<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Daily Blade — Pulp Fantasy</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Cinzel+Decorative:wght@700&family=IM+Fell+English:ital@0;1&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root { --ink:#1a0d05; --parchment:#f4e8cf; --aged:#e2d0a8; --blood:#8b1a1a; --gold:#c9922a; --darkgold:#7a4f0d; --muted:#5c3d1e; }
    html { scroll-behavior: smooth; }
    body { background:var(--ink); color:var(--parchment); font-family:'IM Fell English',Georgia,serif; min-height:100vh; line-height:1.7; }
    body::before { content:''; position:fixed; inset:0; background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.07'/%3E%3C/svg%3E"); pointer-events:none; z-index:0; opacity:0.4; }
    .page-wrap { position:relative; z-index:1; max-width:1100px; margin:0 auto; padding:0 1.5rem 4rem; }
    .masthead { text-align:center; padding:2.5rem 1rem 1.5rem; border-bottom:3px double var(--gold); }
    .masthead::after { content:'⚔ ✦ ⚔'; display:block; color:var(--gold); font-size:1.1rem; letter-spacing:.4em; margin-top:.5rem; }
    .masthead-eyebrow { font-family:'Cinzel',serif; font-size:.72rem; letter-spacing:.35em; color:var(--gold); text-transform:uppercase; margin-bottom:.5rem; }
    .masthead-title { font-family:'Cinzel Decorative','Cinzel',serif; font-size:clamp(2.4rem,7vw,5rem); font-weight:700; color:var(--parchment); text-shadow:3px 3px 0 var(--blood),5px 5px 10px rgba(0,0,0,.7); line-height:1.1; }
    .masthead-sub { font-family:'Cinzel',serif; font-size:.8rem; letter-spacing:.25em; color:var(--aged); margin-top:.6rem; }
    .masthead-date { margin-top:.8rem; font-style:italic; font-size:.85rem; color:var(--gold); }
    .controls { display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; gap:1rem; padding:1.5rem 0 .5rem; border-bottom:1px solid rgba(201,146,42,.25); margin-bottom:2rem; }
    .controls-left { font-family:'Cinzel',serif; font-size:.72rem; letter-spacing:.2em; color:var(--gold); text-transform:uppercase; }
    #status-msg { text-align:center; padding:3rem 1rem; font-style:italic; color:var(--aged); }
    .spinner { display:inline-block; width:1.4rem; height:1.4rem; border:3px solid rgba(201,146,42,.2); border-top-color:var(--gold); border-radius:50%; animation:spin 0.9s linear infinite; vertical-align:middle; margin-right:.6rem; }
    @keyframes spin { to { transform:rotate(360deg); } }
    .story-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(480px,1fr)); gap:1.8rem; }
    @media (max-width:560px) { .story-grid { grid-template-columns:1fr; } }
    .story-card { background:linear-gradient(160deg,#1e0e06 0%,#130b04 100%); border:1px solid rgba(201,146,42,.35); border-top:3px solid var(--blood); border-radius:3px; padding:1.5rem 1.8rem 1.6rem; position:relative; overflow:hidden; box-shadow:0 4px 20px rgba(0,0,0,.5); transition:transform .2s,box-shadow .2s; }
    .story-card:hover { transform:translateY(-2px); box-shadow:0 8px 28px rgba(0,0,0,.65); }
    .story-card::before { content:'✦'; position:absolute; top:.6rem; right:.9rem; color:var(--blood); font-size:.8rem; opacity:.6; }
    .story-number { font-family:'Cinzel',serif; font-size:.65rem; letter-spacing:.3em; color:var(--blood); text-transform:uppercase; margin-bottom:.3rem; }
    .story-tag { display:inline-block; font-family:'Cinzel',serif; font-size:.6rem; letter-spacing:.2em; text-transform:uppercase; color:var(--gold); border:1px solid rgba(201,146,42,.4); padding:.15rem .5rem; border-radius:2px; margin-bottom:.7rem; }
    .story-title { font-family:'Cinzel',serif; font-size:1.12rem; font-weight:700; color:var(--parchment); line-height:1.3; margin-bottom:.9rem; }
    .story-divider { border:none; border-top:1px solid rgba(201,146,42,.25); margin-bottom:.9rem; }
    .story-text { font-size:.9rem; color:var(--aged); line-height:1.75; text-align:justify; hyphens:auto; }
    .story-text::first-letter { float:left; font-family:'Cinzel Decorative','Cinzel',serif; font-size:3.2rem; line-height:.75; padding-right:.12em; color:var(--gold); }
    .error-box { background:rgba(139,26,26,.12); border:1px solid var(--blood); border-radius:3px; padding:1.2rem 1.5rem; text-align:center; color:#e07070; font-style:italic; font-size:.9rem; max-width:600px; margin:0 auto; }
    .error-box strong { display:block; font-family:'Cinzel',serif; font-size:.75rem; letter-spacing:.2em; color:var(--blood); margin-bottom:.4rem; }
    footer { text-align:center; padding:2rem 1rem; border-top:3px double rgba(201,146,42,.3); margin-top:3rem; font-style:italic; font-size:.78rem; color:var(--muted); }
    footer strong { color:var(--gold); font-style:normal; font-family:'Cinzel',serif; letter-spacing:.15em; }
  </style>
</head>
<body>
<div class="page-wrap">
  <header class="masthead">
    <p class="masthead-eyebrow">Est. Anno Domini — Daily Edition</p>
    <h1 class="masthead-title">The Daily Blade</h1>
    <p class="masthead-sub">Ten Tales of Sword &amp; Sorcery — Fresh Each Dawn</p>
    <p class="masthead-date" id="today-date"></p>
  </header>
  <div class="controls">
    <span class="controls-left" id="story-count-label">— Loading today's tales… —</span>
  </div>
  <div id="status-msg"><span class="spinner"></span><em>Summoning the stories…</em></div>
  <div class="story-grid" id="story-grid" style="display:none;"></div>
  <footer>
    <strong>The Daily Blade</strong> &nbsp;·&nbsp;
    Stories generated by <strong>Claude</strong> AI &nbsp;·&nbsp;
    New tales conjured each dawn &nbsp;·&nbsp;
    All characters, sorceries &amp; kingdoms are entirely fictitious
  </footer>
</div>
<script>
  const STORIES_URL='./stories.json';
  function todayStr(){return new Date().toISOString().slice(0,10);}
  function formatDate(s){const d=new Date(s+'T12:00:00');return d.toLocaleDateString('en-US',{weekday:'long',year:'numeric',month:'long',day:'numeric'});}
  function escHtml(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');}
  function setStatus(h){document.getElementById('status-msg').innerHTML=h;document.getElementById('status-msg').style.display='';document.getElementById('story-grid').style.display='none';}
  function renderStories(data){
    document.getElementById('status-msg').style.display='none';
    const grid=document.getElementById('story-grid');grid.innerHTML='';grid.style.display='';
    data.stories.forEach((s,i)=>{
      const c=document.createElement('article');c.className='story-card';
      c.innerHTML='<p class="story-number">Tale '+String(i+1).padStart(2,'0')+' of 10</p><span class="story-tag">'+escHtml(s.subgenre||'Sword & Sorcery')+'</span><h2 class="story-title">'+escHtml(s.title||'Untitled')+'</h2><hr class="story-divider"/><p class="story-text">'+escHtml(s.text||'')+'</p>';
      grid.appendChild(c);
    });
    document.getElementById('story-count-label').textContent=data.date===todayStr()?'— Ten tales of blood and glory, conjured this very dawn —':'— Tales from '+formatDate(data.date)+' —';
  }
  async function loadStories(){
    try{
      const res=await fetch(STORIES_URL+'?t='+Date.now());
      if(!res.ok){if(res.status===404){setStatus('<div class="error-box"><strong>⚔ No Tales Yet</strong>Check back after 6 AM UTC or trigger the workflow manually.</div>');}else{throw new Error('HTTP '+res.status);}return;}
      const data=await res.json();
      if(!data.stories||!data.stories.length)throw new Error('No stories found.');
      renderStories(data);
    }catch(err){setStatus('<div class="error-box"><strong>⚠ The Ritual Failed</strong>'+escHtml(err.message)+'</div>');}
  }
  document.getElementById('today-date').textContent=formatDate(todayStr());
  loadStories();
</script>
</body>
</html>
